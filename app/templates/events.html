{% extends "base.html" %}

{% block app_content %}
    <div class="main-page">
        <div class="page-content">
          <div class="form-horizontal spell-components">
            <h2 id="spell-heading">Spell Components</h2>
              <form name="main-form" id="main-form">
                {{ form.csrf_token }}
                
                <p>
                  {{ form.activity.label }}
                  {{ form.activity() }}
                </p>
                
                <div>
                  {{ form.location.label }}
                  <br>
                  {{ form.location() }}
                </div>
                <br>
                
                <div>
                  {{ form.price.label }}
                  {{ form.price() }}
                </div>
                
                <div>
                  {{ form.category.label }}
                  {{ form.category() }}
                </div>
              </form>
              <div class="showhide-wrapper">
                  <a id="hide-button" onclick="hideSearch()">Hide Advanced Search</a>
                  <a id="show-button" onclick="showSearch()">Show Advanced Search</a>
              </div>
          </div>
          <div id="pageData">
            <div id="results">
              {% if query and (query != '') %}
              <p>Showing results for: "{{ query }}"</p>
              {% endif %}
            </div>
            <div class="event-search">
              <input type="text" id="event-search" placeholder="Quick Cast" onkeyup="quickSearch(this.value)"/>
              <button onclick="clearFields()">Clear</button>
            </div>
            <br>
            {% for piece in data %}
            <div class="event">
                <h2>{{ piece.name }}</h2>
                <div class="body-text">{{ piece.location }}</div>
                
                <div class="call-out">{{ piece.event_type if piece.event_type}}</div>
                
                <div>{{ piece.category if piece.category }}</div>
                
                <div>{{ '$' if piece.price }}{{ piece.price if piece.price }}</div>
            </div>
            {% endfor %}
            <div id="no-results">No results found</div>
          </div>
          <div id="ad-space-right">
            <p>Google ad space</p>
          </div>
          <div id="myModal" class="modal" onclick="hideModal()">
            <!-- The Close Button -->
            <span class="close" onclick="hideModal()">&times;</span>
            <!-- Modal Content (Event Info) -->
            <div id="modal-content">
              <div id="google-map">Google maps space</div>
              <div id="event-info"></div>
            </div>
          </div>
        </div>
        <script type="application/javascript" src="{{ url_for('static', filename='JS/events_page.min.js') }}"></script>
        <script>
            eventsClickable();
            hideModal();
        </script>
        {% if (query != '') %}
        <script>             
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const query = urlParams.get('query');
            console.log(query);
            quickSearch(query);
        </script>
        {% endif %}
    </div>
{% endblock %}